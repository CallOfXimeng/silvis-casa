---
layout: default
---

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/5.4.2/photoswipe.min.css">

<style>
    body {
        background-color: #f5f5f7;
    }

    .photo-stream {
        max-width: 1200px;
        margin: 0 auto;
        padding: 40px 20px;
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
    }

    @media (max-width: 1024px) {
        .photo-stream {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 600px) {
        .photo-stream {
            grid-template-columns: 1fr;
        }
    }

    .photo-post {
        background: linear-gradient(145deg, rgba(255, 255, 255, 0.7), rgba(255, 230, 180, 0.5));
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 165, 0, 0.2);
        border-radius: 12px;
        padding: 15px;
        box-shadow: 0 4px 16px rgba(255, 140, 0, 0.08);
        display: flex;
        flex-direction: column;
    }

    .photo-meta {
        margin-bottom: 10px;
        color: #e67e22;
        font-weight: bold;
        font-size: 0.8rem;
    }

    .photo-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 4px;
        margin-bottom: 12px;
    }

    .grid-item {
        aspect-ratio: 1 / 1;
        position: relative;
        overflow: hidden;
        border-radius: 4px;
        background: rgba(0, 0, 0, 0.03);
    }

    .grid-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        /* ä¿è¯ç¼©ç•¥å›¾ä¸å‹æ‰ */
        cursor: pointer;
        transition: transform 0.3s ease;
    }

    .grid-item img:hover {
        transform: scale(1.05);
    }

    .hidden-images {
        display: none;
    }

    .more-mask {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.4);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1rem;
        pointer-events: none;
        backdrop-filter: blur(1px);
    }

    .photo-content {
        line-height: 1.4;
        color: #555;
        font-size: 0.85rem;
    }
</style>

<div class="photo-stream">
    {% if site.data.moments %}
    {% assign sorted_moments = site.data.moments | sort: 'date' | reverse %}
    {% for moment in sorted_moments %}
    <div class="photo-post">
        <div class="photo-meta">ğŸ“… {{ moment.date }}</div>

        <div class="photo-grid pswp-gallery">
            {% assign folder_path = "/assets/img/" | append: moment.folder | append: "/" %}
            {% assign images = site.static_files | where_exp: "item", "item.path contains folder_path" %}

            {% for img_file in images %}
            {% if forloop.index <= 9 %} <div class="grid-item">
                <a href="{{ img_file.path | relative_url }}" target="_blank">
                    <img src="{{ img_file.path | relative_url }}" alt="Photo" loading="lazy">
                </a>
                {% if forloop.index == 9 and images.size > 9 %}
                <div class="more-mask">+{{ images.size | minus: 9 }}</div>
                {% endif %}
        </div>
        {% else %}
        <a href="{{ img_file.path | relative_url }}" class="hidden-images" target="_blank">
            <img src="{{ img_file.path | relative_url }}" alt="Photo">
        </a>
        {% endif %}
        {% endfor %}
    </div>

    <div class="photo-content">
        {{ moment.text | markdownify }}
    </div>
</div>
{% endfor %}
{% endif %}
</div>

<script type="module">
    import PhotoSwipeLightbox from 'https://cdnjs.cloudflare.com/ajax/libs/photoswipe/5.4.2/photoswipe-lightbox.esm.min.js';

    const lightbox = new PhotoSwipeLightbox({
        gallery: '.pswp-gallery',
        children: 'a',
        pswpModule: () => import('https://cdnjs.cloudflare.com/ajax/libs/photoswipe/5.4.2/photoswipe.esm.min.js')
    });

    // ã€å…³é”®ä¿®å¤ã€‘åŠ¨æ€è¯†åˆ«å›¾ç‰‡åŸå§‹å®½é«˜ï¼Œè§£å†³å‹æ‰é—®é¢˜
    lightbox.addFilter('domItemData', (itemData, element, linkEl) => {
        const img = element.querySelector('img');
        if (img) {
            // å¦‚æœå›¾ç‰‡å·²åŠ è½½ï¼Œç›´æ¥ä½¿ç”¨å®ƒçš„è‡ªç„¶å®½é«˜
            if (img.naturalWidth) {
                itemData.width = img.naturalWidth;
                itemData.height = img.naturalHeight;
            } else {
                // å¦‚æœæœªåŠ è½½ï¼ˆå¦‚éšè—å›¾ç‰‡ï¼‰ï¼Œé¢„è®¾ä¸€ä¸ªå¤§æ¯”ä¾‹ï¼Œ
                // æˆ–è€…åœ¨è¿™é‡Œè§¦å‘ä¸€ä¸ª Image å¯¹è±¡é¢„è½½ï¼ˆPhotoSwipe 5 é€šå¸¸èƒ½å¤„ç†æ­¤ç±»æƒ…å†µï¼‰
                itemData.width = 1600;
                itemData.height = 1200;
            }
        }
        return itemData;
    });

    lightbox.init();
</script>